{"ast":null,"code":"import _objectSpread from\"C:/Users/Fablab Makandura/Documents/GitHub/react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Fablab Makandura/Documents/GitHub/react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import{query,collection,orderBy,onSnapshot,limit}from\"firebase/firestore\";import{db}from\"../firebase\";import Message from\"./Message\";import SendMessage from\"./SendMessage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatBox=function ChatBox(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var scroll=useRef();useEffect(function(){var q=query(collection(db,\"messages\"),orderBy(\"createdAt\"),limit(50));var unsubscribe=onSnapshot(q,function(QuerySnapshot){var messages=[];QuerySnapshot.forEach(function(doc){messages.push(_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id}));});setMessages(messages);});return function(){return unsubscribe;};},[]);return/*#__PURE__*/_jsxs(\"main\",{className:\"chat-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages-wrapper\",children:messages===null||messages===void 0?void 0:messages.map(function(message){return/*#__PURE__*/_jsx(Message,{message:message},message.id);})}),/*#__PURE__*/_jsx(\"span\",{ref:scroll}),/*#__PURE__*/_jsx(SendMessage,{scroll:scroll})]});};export default ChatBox;","map":{"version":3,"names":["React","useEffect","useRef","useState","query","collection","orderBy","onSnapshot","limit","db","Message","SendMessage","ChatBox","messages","setMessages","scroll","q","unsubscribe","QuerySnapshot","forEach","doc","push","data","id","map","message"],"sources":["C:/Users/Fablab Makandura/Documents/GitHub/react/src/components/ChatBox.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  query,\r\n  collection,\r\n  orderBy,\r\n  onSnapshot,\r\n  limit,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../firebase\";\r\nimport Message from \"./Message\";\r\nimport SendMessage from \"./SendMessage\";\r\n\r\nconst ChatBox = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const scroll = useRef();\r\n\r\n  useEffect(() => {\r\n    const q = query(\r\n      collection(db, \"messages\"),\r\n      orderBy(\"createdAt\"),\r\n      limit(50)\r\n    );\r\n\r\n    const unsubscribe = onSnapshot(q, (QuerySnapshot) => {\r\n      let messages = [];\r\n      QuerySnapshot.forEach((doc) => {\r\n        messages.push({ ...doc.data(), id: doc.id });\r\n      });\r\n      setMessages(messages);\r\n    });\r\n    return () => unsubscribe;\r\n  }, []);\r\n\r\n  return (\r\n    <main className=\"chat-box\">\r\n      <div className=\"messages-wrapper\">\r\n        {messages?.map((message) => (\r\n          <Message key={message.id} message={message} />\r\n        ))}\r\n      </div>\r\n      {/* when a new message enters the chat, the screen scrolls dowwn to the scroll div */}\r\n      <span ref={scroll}></span>\r\n      <SendMessage scroll={scroll} />\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default ChatBox;\r\n"],"mappings":"2QAAA,MAAOA,MAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,OACEC,KAAK,CACLC,UAAU,CACVC,OAAO,CACPC,UAAU,CACVC,KAAK,KACA,oBAAoB,CAC3B,OAASC,EAAE,KAAQ,aAAa,CAChC,MAAOC,QAAO,KAAM,WAAW,CAC/B,MAAOC,YAAW,KAAM,eAAe,CAAC,wFAExC,GAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpB,cAAgCT,QAAQ,CAAC,EAAE,CAAC,wCAArCU,QAAQ,eAAEC,WAAW,eAC5B,GAAMC,OAAM,CAAGb,MAAM,EAAE,CAEvBD,SAAS,CAAC,UAAM,CACd,GAAMe,EAAC,CAAGZ,KAAK,CACbC,UAAU,CAACI,EAAE,CAAE,UAAU,CAAC,CAC1BH,OAAO,CAAC,WAAW,CAAC,CACpBE,KAAK,CAAC,EAAE,CAAC,CACV,CAED,GAAMS,YAAW,CAAGV,UAAU,CAACS,CAAC,CAAE,SAACE,aAAa,CAAK,CACnD,GAAIL,SAAQ,CAAG,EAAE,CACjBK,aAAa,CAACC,OAAO,CAAC,SAACC,GAAG,CAAK,CAC7BP,QAAQ,CAACQ,IAAI,gCAAMD,GAAG,CAACE,IAAI,EAAE,MAAEC,EAAE,CAAEH,GAAG,CAACG,EAAE,GAAG,CAC9C,CAAC,CAAC,CACFT,WAAW,CAACD,QAAQ,CAAC,CACvB,CAAC,CAAC,CACF,MAAO,kBAAMI,YAAW,GAC1B,CAAC,CAAE,EAAE,CAAC,CAEN,mBACE,cAAM,SAAS,CAAC,UAAU,wBACxB,YAAK,SAAS,CAAC,kBAAkB,UAC9BJ,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEW,GAAG,CAAC,SAACC,OAAO,qBACrB,KAAC,OAAO,EAAkB,OAAO,CAAEA,OAAQ,EAA7BA,OAAO,CAACF,EAAE,CAAsB,EAC/C,CAAC,EACE,cAEN,aAAM,GAAG,CAAER,MAAO,EAAQ,cAC1B,KAAC,WAAW,EAAC,MAAM,CAAEA,MAAO,EAAG,GAC1B,CAEX,CAAC,CAED,cAAeH,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}